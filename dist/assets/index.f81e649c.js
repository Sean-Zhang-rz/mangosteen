import{h as I,d as b,i as tt,e as n,t as z,j as A,k as nt,l as C,m as k,n as q,B as et,I as ot,p as at,L as lt,q as st,c as M,s as it,v as ct,x as rt,y as ut,r as L,z as dt,A as V,C as ft,D as mt,P as gt,E as Bt,F as H,G as vt,H as pt,J as yt,K as _t,M as Ct,N as ht,O as bt,Q as wt,b as W,u as G,o as St,f as h,g as P,S as kt}from"./index.1c216f5b.js";import{I as O}from"./index.16a27d37.js";const[J,xt]=I("action-bar"),Q=Symbol(J),Pt={safeAreaInsetBottom:z};var Ot=b({name:J,props:Pt,setup(t,{slots:o}){const{linkChildren:e}=tt(Q);return e(),()=>{var l;return n("div",{class:[xt(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[(l=o.default)==null?void 0:l.call(o)])}}});const Tt=A(Ot),Y={to:[String,Object],url:String,replace:Boolean};function Ft({to:t,url:o,replace:e,$router:l}){t&&l?l[e?"replace":"push"](t):o&&(e?location.replace(o):location.href=o)}function X(){const t=nt().proxy;return()=>Ft(t)}const[$t,S]=I("button"),It=C({},Y,{tag:k("button"),text:String,icon:String,type:k("default"),size:k("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:k("button"),loadingSize:q,loadingText:String,loadingType:String,iconPosition:k("left")});var At=b({name:$t,props:It,emits:["click"],setup(t,{emit:o,slots:e}){const l=X(),r=()=>e.loading?e.loading():n(lt,{size:t.loadingSize,type:t.loadingType,class:S("loading")},null),f=()=>{if(t.loading)return r();if(e.icon)return n("div",{class:S("icon")},[e.icon()]);if(t.icon)return n(ot,{name:t.icon,class:S("icon"),classPrefix:t.iconPrefix},null)},v=()=>{let s;if(t.loading?s=t.loadingText:s=e.default?e.default():t.text,s)return n("span",{class:S("text")},[s])},c=()=>{const{color:s,plain:_}=t;if(s){const p={color:_?s:"white"};return _||(p.background=s),s.includes("gradient")?p.border=0:p.borderColor=s,p}},d=s=>{t.loading?at(s):t.disabled||(o("click",s),l())};return()=>{const{tag:s,type:_,size:p,block:x,round:D,plain:R,square:E,loading:N,disabled:a,hairline:u,nativeType:y,iconPosition:g}=t,w=[S([_,p,{plain:R,block:x,round:D,square:E,loading:N,disabled:a,hairline:u}]),{[et]:u}];return n(s,{type:y,class:w,style:c(),disabled:a,onClick:d},{default:()=>[n("div",{class:S("content")},[g==="left"&&f(),v(),g==="right"&&f()])]})}}});const U=A(At),[Dt,Rt]=I("action-bar-button"),Et=C({},Y,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Nt=b({name:Dt,props:Et,setup(t,{slots:o}){const e=X(),{parent:l,index:r}=st(Q),f=M(()=>{if(l){const c=l.children[r.value-1];return!(c&&"isButton"in c)}}),v=M(()=>{if(l){const c=l.children[r.value+1];return!(c&&"isButton"in c)}});return it({isButton:!0}),()=>{const{type:c,icon:d,text:s,color:_,loading:p,disabled:x}=t;return n(U,{class:Rt([c,{last:v.value,first:f.value}]),size:"large",type:c,icon:d,color:_,loading:p,disabled:x,onClick:e},{default:()=>[o.default?o.default():s]})}}});const K=A(Nt),[jt,B,F]=I("dialog"),zt=C({},ct,{title:String,theme:String,width:q,message:[String,Function],callback:Function,allowHtml:Boolean,className:rt,transition:k("van-dialog-bounce"),messageAlign:String,closeOnPopstate:z,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:z,closeOnClickOverlay:Boolean}),Ut=[...ut,"transition","closeOnPopstate"];var Z=b({name:jt,props:zt,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:o,slots:e}){const l=L(),r=dt({confirm:!1,cancel:!1}),f=a=>o("update:show",a),v=a=>{var u;f(!1),(u=t.callback)==null||u.call(t,a)},c=a=>()=>{!t.show||(o(a),t.beforeClose?(r[a]=!0,_t(t.beforeClose,{args:[a],done(){v(a),r[a]=!1},canceled(){r[a]=!1}})):v(a))},d=c("cancel"),s=c("confirm"),_=Bt(a=>{var u,y;if(a.target!==((y=(u=l.value)==null?void 0:u.popupRef)==null?void 0:y.value))return;({Enter:t.showConfirmButton?s:H,Escape:t.showCancelButton?d:H})[a.key](),o("keydown",a)},["enter","esc"]),p=()=>{const a=e.title?e.title():t.title;if(a)return n("div",{class:B("header",{isolated:!t.message&&!e.default})},[a])},x=a=>{const{message:u,allowHtml:y,messageAlign:g}=t,w=B("message",{"has-title":a,[g]:g}),j=vt(u)?u():u;return y&&typeof j=="string"?n("div",{class:w,innerHTML:j},null):n("div",{class:w},[j])},D=()=>{if(e.default)return n("div",{class:B("content")},[e.default()]);const{title:a,message:u,allowHtml:y}=t;if(u){const g=!!(a||e.title);return n("div",{key:y?1:0,class:B("content",{isolated:!g})},[x(g)])}},R=()=>n("div",{class:[yt,B("footer")]},[t.showCancelButton&&n(U,{size:"large",text:t.cancelButtonText||F("cancel"),class:B("cancel"),style:{color:t.cancelButtonColor},loading:r.cancel,onClick:d},null),t.showConfirmButton&&n(U,{size:"large",text:t.confirmButtonText||F("confirm"),class:[B("confirm"),{[pt]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:r.confirm,onClick:s},null)]),E=()=>n(Tt,{class:B("footer")},{default:()=>[t.showCancelButton&&n(K,{type:"warning",text:t.cancelButtonText||F("cancel"),class:B("cancel"),color:t.cancelButtonColor,loading:r.cancel,onClick:d},null),t.showConfirmButton&&n(K,{type:"danger",text:t.confirmButtonText||F("confirm"),class:B("confirm"),color:t.confirmButtonColor,loading:r.confirm,onClick:s},null)]}),N=()=>e.footer?e.footer():t.theme==="round-button"?E():R();return()=>{const{width:a,title:u,theme:y,message:g,className:w}=t;return n(gt,V({ref:l,role:"dialog",class:[B([y]),w],style:{width:mt(a)},tabindex:0,"aria-labelledby":u||g,onKeydown:_,"onUpdate:show":f},ft(t,Ut)),{default:()=>[p(),D(),N()]})}}});let T;function Lt(){({instance:T}=ht({setup(){const{state:o,toggle:e}=bt();return()=>n(Z,V(o,{"onUpdate:show":e}),null)}}))}function i(t){return Ct?new Promise((o,e)=>{T||Lt(),T.open(C({},i.currentOptions,t,{callback:l=>{(l==="confirm"?o:e)(l)}}))}):Promise.resolve()}i.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};i.currentOptions=C({},i.defaultOptions);i.alert=i;i.confirm=t=>i(C({showCancelButton:!0},t));i.close=()=>{T&&T.toggle(!1)};i.setDefaultOptions=t=>{C(i.currentOptions,t)};i.resetDefaultOptions=()=>{i.currentOptions=C({},i.defaultOptions)};i.Component=A(Z);i.install=t=>{t.use(i.Component),t.config.globalProperties.$dialog=i};const Mt="_mask_1jnat_1",Ht="_email_1jnat_11",Kt="_overlay_1jnat_17",qt="_currentUser_1jnat_27",Vt="_action_1jnat_33",Wt="_action_list_1jnat_39",Gt="_icon_1jnat_46",m={mask:Mt,email:Ht,overlay:Kt,currentUser:qt,action:Vt,action_list:Wt,icon:Gt},Jt=b({props:{onClose:{type:Function}},setup:(t,o)=>{const e=wt(),l=W(),r=G(),f=L();St(async()=>{const d=await e.me;f.value=d==null?void 0:d.data});const v=async()=>{await i.confirm({title:"\u786E\u8BA4",message:"\u786E\u8BA4\u8981\u9000\u51FA\u767B\u5F55\u5417\uFF1F"}),localStorage.removeItem("jwt"),r.push("/sign_in")},c=()=>{var d;(d=t.onClose)==null||d.call(t)};return()=>n(kt,null,[n("div",{class:m.mask,onClick:c},null),n("div",{class:m.overlay},[n("section",{class:m.currentUser},[f.value?n("div",null,[n("h2",{class:m.email},[f.value.email]),n("p",{onClick:v},[h("\u9000\u51FA\u767B\u5F55")])]):n(P,{to:`/sign_in?return_to=${l.fullPath}`},{default:()=>[n("h2",null,[h("\u672A\u767B\u5F55\u7528\u6237")]),n("p",null,[h("\u70B9\u51FB\u8FD9\u91CC\u767B\u5F55")])]})]),n("nav",null,[n("ul",{class:m.action_list},[n("li",null,[n(P,{to:"/items/create",class:m.action},{default:()=>[n(O,{name:"pig",class:m.icon},null),n("span",null,[h("\u8BB0\u8D26")])]})]),n("li",null,[n(P,{to:"/statistics",class:m.action},{default:()=>[n(O,{name:"charts",class:m.icon},null),n("span",null,[h("\u7EDF\u8BA1\u56FE\u8868")])]})]),n("li",null,[n(P,{to:"/export",class:m.action},{default:()=>[n(O,{name:"export",class:m.icon},null),n("span",null,[h("\u5BFC\u51FA\u6570\u636E")])]})]),n("li",null,[n(P,{to:"/notify",class:m.action},{default:()=>[n(O,{name:"notify",class:m.icon},null),n("span",null,[h("\u8BB0\u8D26\u63D0\u9192")])]})])])])])])}}),Qt="_navbar_1ttgt_1",Yt="_icon_wrapper_1ttgt_10",Xt="_title_wrapper_1ttgt_22",$={navbar:Qt,icon_wrapper:Yt,title_wrapper:Xt},Zt=b({props:{title:{type:String,required:!0},icon:{type:String,default:"back"}},setup:({title:t,icon:o})=>{const e=L(!1),l=W(),r=G(),f=()=>{const{return_to:c}=l.query;c?r.push(c.toString()):r.back()},v=()=>{e.value=!e.value};return()=>n("div",{class:$.navbar},[o?n("span",{class:$.icon_wrapper},[n(O,{name:o,class:$.icon,onClick:o==="menu"?v:f},null)]):null,n("span",{class:$.title_wrapper},[t]),o==="menu"&&e.value===!0?n(Jt,{onClose:()=>{e.value=!1}},null):null])}}),en=b({props:{title:{type:String,default:"back"},icon:{type:String,default:"back"}},setup:(t,o)=>()=>{var e,l;return n("div",null,[n(Zt,{title:t.title,icon:t.icon},null),(l=(e=o.slots)==null?void 0:e.default)==null?void 0:l.call(e)])}});export{i as D,en as M};
